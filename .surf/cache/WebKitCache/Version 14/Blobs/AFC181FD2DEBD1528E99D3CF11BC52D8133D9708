System.register("src/gui/base/icons/Logo.js",["../../../api/Env"],function(_export,_context){"use strict";var assertMainOrNodeBoot,Logo,LogoSvg;return{setters:[function(_apiEnv){assertMainOrNodeBoot=_apiEnv.assertMainOrNodeBoot}],execute:function(){assertMainOrNodeBoot(),_export("Logo",Logo=Object.freeze({Red:"Red",Cyan:"Cyan"})),_export("Logo",Logo),_export("LogoSvg",LogoSvg={Red:'<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMid" viewBox="0 0 1054.473 236.49"><g fill="#4a4a4a"><path d="M361.388 77.059h-42.696v-8.082h94.178v8.082h-42.696v121.939h-8.785V77.059zM410.581 173.697v-66.943h8.434v65.889c0 14.057 6.15 20.908 20.206 20.908 12.827 0 23.544-6.676 34.965-17.57v-69.228h8.434v92.245h-8.434v-15.285c-10.191 9.662-22.139 17.219-35.668 17.219-19.152-.001-27.937-10.543-27.937-27.235zM519.691 178.441v-64.133h-16.165v-7.555h16.165v-33.56h8.434v33.56h24.071v7.555h-24.071v62.902c0 9.84 3.339 15.463 14.935 15.463 3.515 0 7.028-.352 9.664-1.23v7.906c-2.987.527-6.501.879-10.366.879-15.287 0-22.667-6.15-22.667-21.787zM570.642 177.738c0-17.57 14.935-30.749 63.43-38.831v-5.623c0-14.056-7.38-21.084-20.03-21.084-15.287 0-25.478 5.974-35.845 15.287l-4.919-5.271c11.421-10.542 23.192-17.395 40.938-17.395 19.152 0 28.289 10.894 28.289 27.937v43.399c0 11.246.703 18.097 2.636 22.841h-8.961c-1.23-3.865-2.108-8.434-2.108-13.705-11.245 9.664-23.545 15.287-37.426 15.287-16.868 0-26.004-8.785-26.004-22.842zm63.429-.703v-31.803c-44.98 7.907-54.996 18.976-54.996 31.978 0 10.367 6.853 15.99 18.273 15.99 13.706.001 26.18-5.974 36.723-16.165z"/></g><g fill="#4a4a4a"><path d="M671.323 198.998v-92.772h15.286v13.881c8.083-7.907 19.68-15.813 34.79-15.813 17.746 0 27.41 10.191 27.41 27.762v66.943h-15.111v-63.604c0-12.299-5.271-18.098-17.043-18.098-11.069 0-20.382 5.798-30.046 14.935V199h-15.286zM770.944 152.612c0-31.978 20.382-48.319 43.224-48.319 22.666 0 43.048 16.341 43.048 48.319 0 31.802-20.382 48.319-43.048 48.319s-43.224-16.517-43.224-48.319zm70.986 0c0-19.328-9.313-35.316-27.762-35.316-17.746 0-27.937 14.408-27.937 35.316 0 19.679 9.137 35.493 27.937 35.493 17.57 0 27.762-14.233 27.762-35.493zM886.907 176.508v-57.807h-16.165v-12.475h16.165V73.194h15.11v33.032h24.072v12.475h-24.072v54.469c0 9.84 3.163 14.76 14.408 14.76 3.338 0 7.028-.527 9.488-1.23v12.475c-2.636.527-8.435 1.055-13.178 1.055-19.503-.002-25.828-7.556-25.828-23.722zM942.429 177.035c0-18.801 15.988-32.154 62.023-38.655v-4.217c0-11.597-6.149-17.219-17.57-17.219-14.057 0-24.423 6.15-33.56 14.056l-7.907-9.488c10.718-9.839 24.599-17.219 43.048-17.219 22.139 0 30.924 11.597 30.924 30.924v40.939c0 11.246.703 18.097 2.636 22.841h-15.462c-1.229-3.865-2.108-7.555-2.108-12.826-10.366 9.664-21.963 14.232-35.844 14.232-15.99.001-26.18-8.432-26.18-23.368zm62.023-2.108v-26.004c-35.316 5.623-47.089 14.232-47.089 25.829 0 8.961 5.974 13.706 15.638 13.706 12.299-.001 22.842-5.097 31.451-13.531z"/></g><path d="M22.875 0C10.235 0 0 10.246 0 22.872v211.23c0 .801.046 1.608.123 2.388 8.5-3.167 17.524-6.629 27.054-10.436 66.336-26.48 120.569-48.994 120.618-74.415 0-.814-.056-1.636-.172-2.458-3.43-25.098-63.407-32.879-63.324-44.381.007-.611.18-1.25.548-1.889 7.205-12.619 35.743-12.015 46.253-12.907 10.519-.913 35.206-.724 36.399-8.244.035-.232.057-.463.057-.695.028-6.987-16.977-9.726-16.977-9.726s20.635 3.083 20.579 11.11c0 .393-.048.8-.158 1.214-2.222 8.624-20.379 10.246-32.386 10.835-11.356.569-28.648 1.861-28.707 7.408-.007.323.049.66.165 1.004 2.71 8.11 66.09 12.015 106.64 33.061 23.335 12.099 34.94 32.422 40.263 53.418V22.869c0-12.626-10.243-22.872-22.869-22.872H22.875z" fill="#840010"/></svg>',Cyan:'<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMid" viewBox="0 0 1054.473 236.49"><g fill="#c5c7c7"><path d="M361.388 77.059h-42.696v-8.082h94.178v8.082h-42.696v121.939h-8.785V77.059zM410.581 173.697v-66.943h8.434v65.889c0 14.057 6.15 20.908 20.206 20.908 12.827 0 23.544-6.676 34.965-17.57v-69.228h8.434v92.245h-8.434v-15.285c-10.191 9.662-22.139 17.219-35.668 17.219-19.152-.001-27.937-10.543-27.937-27.235zM519.691 178.441v-64.133h-16.165v-7.555h16.165v-33.56h8.434v33.56h24.071v7.555h-24.071v62.902c0 9.84 3.339 15.463 14.935 15.463 3.515 0 7.028-.352 9.664-1.23v7.906c-2.987.527-6.501.879-10.366.879-15.287 0-22.667-6.15-22.667-21.787zM570.642 177.738c0-17.57 14.935-30.749 63.43-38.831v-5.623c0-14.056-7.38-21.084-20.03-21.084-15.287 0-25.478 5.974-35.845 15.287l-4.919-5.271c11.421-10.542 23.192-17.395 40.938-17.395 19.152 0 28.289 10.894 28.289 27.937v43.399c0 11.246.703 18.097 2.636 22.841h-8.961c-1.23-3.865-2.108-8.434-2.108-13.705-11.245 9.664-23.545 15.287-37.426 15.287-16.868 0-26.004-8.785-26.004-22.842zm63.429-.703v-31.803c-44.98 7.907-54.996 18.976-54.996 31.978 0 10.367 6.853 15.99 18.273 15.99 13.706.001 26.18-5.974 36.723-16.165z"/></g><g fill="#c5c7c7"><path d="M671.323 198.998v-92.772h15.286v13.881c8.083-7.907 19.68-15.813 34.79-15.813 17.746 0 27.41 10.191 27.41 27.762v66.943h-15.111v-63.604c0-12.299-5.271-18.098-17.043-18.098-11.069 0-20.382 5.798-30.046 14.935V199h-15.286zM770.944 152.612c0-31.978 20.382-48.319 43.224-48.319 22.666 0 43.048 16.341 43.048 48.319 0 31.802-20.382 48.319-43.048 48.319s-43.224-16.517-43.224-48.319zm70.986 0c0-19.328-9.313-35.316-27.762-35.316-17.746 0-27.937 14.408-27.937 35.316 0 19.679 9.137 35.493 27.937 35.493 17.57 0 27.762-14.233 27.762-35.493zM886.907 176.508v-57.807h-16.165v-12.475h16.165V73.194h15.11v33.032h24.072v12.475h-24.072v54.469c0 9.84 3.163 14.76 14.408 14.76 3.338 0 7.028-.527 9.488-1.23v12.475c-2.636.527-8.435 1.055-13.178 1.055-19.503-.002-25.828-7.556-25.828-23.722zM942.429 177.035c0-18.801 15.988-32.154 62.023-38.655v-4.217c0-11.597-6.149-17.219-17.57-17.219-14.057 0-24.423 6.15-33.56 14.056l-7.907-9.488c10.718-9.839 24.599-17.219 43.048-17.219 22.139 0 30.924 11.597 30.924 30.924v40.939c0 11.246.703 18.097 2.636 22.841h-15.462c-1.229-3.865-2.108-7.555-2.108-12.826-10.366 9.664-21.963 14.232-35.844 14.232-15.99.001-26.18-8.432-26.18-23.368zm62.023-2.108v-26.004c-35.316 5.623-47.089 14.232-47.089 25.829 0 8.961 5.974 13.706 15.638 13.706 12.299-.001 22.842-5.097 31.451-13.531z"/></g><path d="M22.875 0C10.235 0 0 10.246 0 22.872v211.23c0 .801.046 1.608.123 2.388 8.5-3.167 17.524-6.629 27.054-10.436 66.336-26.48 120.569-48.994 120.618-74.415 0-.814-.056-1.636-.172-2.458-3.43-25.098-63.407-32.879-63.324-44.381.007-.611.18-1.25.548-1.889 7.205-12.619 35.743-12.015 46.253-12.907 10.519-.913 35.206-.724 36.399-8.244.035-.232.057-.463.057-.695.028-6.987-16.977-9.726-16.977-9.726s20.635 3.083 20.579 11.11c0 .393-.048.8-.158 1.214-2.222 8.624-20.379 10.246-32.386 10.835-11.356.569-28.648 1.861-28.707 7.408-.007.323.049.66.165 1.004 2.71 8.11 66.09 12.015 106.64 33.061 23.335 12.099 34.94 32.422 40.263 53.418V22.869c0-12.626-10.243-22.872-22.869-22.872H22.875z" fill="#00d2a7"/></svg>'}),_export("LogoSvg",LogoSvg)}}}),System.register("src/misc/ClientConstants.js",[],function(_export,_context){"use strict";var BrowserType,DeviceType;return{setters:[],execute:function(){_export("BrowserType",BrowserType=Object.freeze({CHROME:"Chrome",FIREFOX:"Firefox",PALEMOON:"PaleMoon",WATERFOX:"Waterfox",IE:"Internet Explorer",EDGE:"Edge",SAFARI:"Safari",ANDROID:"Android",OPERA:"Opera",BB:"BlackBerry",UBUNTU:"Ubuntu",OTHER:"Other"})),_export("BrowserType",BrowserType),_export("DeviceType",DeviceType=Object.freeze({IPHONE:"iPhone",IPAD:"iPad",ANDROID:"Android",WINDOWS_PHONE:"Windows Phone",BB:"BlackBerry",DESKTOP:"Desktop",OTHER_MOBILE:"Other mobile"})),_export("DeviceType",DeviceType)}}}),System.register("src/misc/ClientDetector.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js","../api/Env","./ClientConstants","../api/common/utils/Utils"],function(_export,_context){"use strict";var _classCallCheck,_createClass,assertMainOrNodeBoot,Mode,BrowserType,DeviceType,neverNull,ClientDetector,client;return{setters:[function(_node_modulesSystemjsPluginBabelBabelHelpersClassCallCheckJs){_classCallCheck=_node_modulesSystemjsPluginBabelBabelHelpersClassCallCheckJs.default},function(_node_modulesSystemjsPluginBabelBabelHelpersCreateClassJs){_createClass=_node_modulesSystemjsPluginBabelBabelHelpersCreateClassJs.default},function(_apiEnv){assertMainOrNodeBoot=_apiEnv.assertMainOrNodeBoot,Mode=_apiEnv.Mode},function(_ClientConstants){BrowserType=_ClientConstants.BrowserType,DeviceType=_ClientConstants.DeviceType},function(_apiCommonUtilsUtils){neverNull=_apiCommonUtilsUtils.neverNull}],execute:function(){assertMainOrNodeBoot(),ClientDetector=function(){function ClientDetector(){_classCallCheck(this,ClientDetector)}return _createClass(ClientDetector,[{key:"init",value:function(userAgent,platform){this.userAgent=userAgent,this.browser=BrowserType.OTHER,this.browserVersion=0,this.device=DeviceType.DESKTOP,this._setBrowserAndVersion(),this._setDeviceInfo(),this.overflowAuto=this.cssPropertyValueSupported("overflow","overlay")?"overlay":"auto",this.isMacOS=-1!==platform.indexOf("Mac")}},{key:"isSupported",value:function(){return this.isSupportedBrowserVersion()&&this.flexbox()&&this.websockets()&&this.xhr2()&&this.randomNumbers()&&this.dateFormat()&&this.blob()&&this.history()&&this.supportsFocus()}},{key:"isMobileDevice",value:function(){return this.device!==DeviceType.DESKTOP}},{key:"isDesktopDevice",value:function(){return this.device===DeviceType.DESKTOP}},{key:"flexbox",value:function(){return"string"==typeof neverNull(document.documentElement).style.flexBasis}},{key:"websockets",value:function(){return"WebSocket"in window&&2===window.WebSocket.CLOSING}},{key:"randomNumbers",value:function(){var crypto=window.crypto||window.msCrypto;if(crypto&&"getRandomValues"in crypto&&"Uint32Array"in window){var array=new Uint8Array(1),values=crypto.getRandomValues(array);return values&&"number"==typeof values[0]}return!1}},{key:"supportsFocus",value:function(){return"undefined"!=typeof HTMLInputElement&&"function"==typeof HTMLInputElement.prototype.focus}},{key:"dateFormat",value:function(){return"undefined"!=typeof Intl}},{key:"blob",value:function(){try{return!!new Blob}catch(e){return!1}}},{key:"localStorage",value:function(_localStorage){function localStorage(){return _localStorage.apply(this,arguments)}return localStorage.toString=function(){return _localStorage.toString()},localStorage}(function(){try{return!!localStorage}catch(e){return!1}})},{key:"history",value:function(){var ua=this.userAgent;return(-1===ua.indexOf("Android 2.")&&-1===ua.indexOf("Android 4.0")||-1===ua.indexOf("Mobile Safari")||-1!==ua.indexOf("Chrome")||-1!==ua.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history)}},{key:"xhr2",value:function(){return"XMLHttpRequest"in window&&"withCredentials"in new XMLHttpRequest}},{key:"indexedDb",value:function(){try{return null!=indexedDB}catch(e){return!1}}},{key:"passive",value:function(){var supportsPassive=!1;try{window.document.addEventListener("test",null,{get passive(){supportsPassive=!0}})}catch(e){}return supportsPassive}},{key:"_setBrowserAndVersion",value:function(){var operaIndex1=this.userAgent.indexOf("Opera"),operaIndex2=this.userAgent.indexOf("OPR/"),firefoxIndex=this.userAgent.indexOf("Firefox/"),paleMoonIndex=this.userAgent.indexOf("PaleMoon/"),iceweaselIndex=this.userAgent.indexOf("Iceweasel/"),waterfoxIndex=this.userAgent.indexOf("Waterfox/"),chromeIndex=this.userAgent.indexOf("Chrome/"),chromeIosIndex=this.userAgent.indexOf("CriOS/"),safariIndex=this.userAgent.indexOf("Safari/"),ieIndex=this.userAgent.indexOf("MSIE"),edgeIndex=this.userAgent.indexOf("Edge"),ie11Index=this.userAgent.indexOf("Trident/7.0"),androidIndex=this.userAgent.indexOf("Android"),blackBerryIndex=this.userAgent.indexOf("BB10"),ubuntuMobileIndex=this.userAgent.indexOf("Ubuntu Mobile"),ubuntuTabletIndex=this.userAgent.indexOf("Ubuntu Tablet"),ubuntuIndex=this.userAgent.indexOf("Ubuntu"),versionIndex=-1;if(-1!==edgeIndex)this.browser=BrowserType.EDGE,versionIndex=edgeIndex+5;else if(-1!==operaIndex1)this.browser=BrowserType.OPERA,-1!==(versionIndex=this.userAgent.indexOf("Version/"))?versionIndex+=8:versionIndex=operaIndex1+6;else if(-1!==operaIndex2)this.browser=BrowserType.OPERA,versionIndex=operaIndex2+4;else if(-1!==paleMoonIndex)this.browser=BrowserType.PALEMOON,versionIndex=paleMoonIndex+9;else if(-1!==waterfoxIndex)this.browser=BrowserType.WATERFOX,versionIndex=waterfoxIndex+9;else if(-1===firefoxIndex&&-1===iceweaselIndex||-1!==operaIndex1||-1!==operaIndex2)if(-1!==chromeIndex)this.browser=BrowserType.CHROME,versionIndex=chromeIndex+7;else if(-1!==androidIndex)-1!==ubuntuIndex?(this.browser=BrowserType.UBUNTU,versionIndex=ubuntuIndex+7):(this.browser=BrowserType.ANDROID,versionIndex=androidIndex+8);else if(-1!==chromeIosIndex)this.browser=BrowserType.CHROME,versionIndex=chromeIosIndex+6;else if(-1!==safariIndex&&-1===chromeIndex&&-1===blackBerryIndex){if(this.browser=BrowserType.SAFARI,-1===(versionIndex=this.userAgent.indexOf("Version/")))return void this.extractIosVersion();versionIndex+=8}else{if(this.userAgent.match(/iPad.*AppleWebKit/)||this.userAgent.match(/iPhone.*AppleWebKit/))return void this.extractIosVersion();-1!==ieIndex?(this.browser=BrowserType.IE,versionIndex=ieIndex+5):-1!==ie11Index?(this.browser=BrowserType.IE,this.browserVersion=11):-1!==blackBerryIndex?(this.browser=BrowserType.BB,this.browserVersion=10):-1===ubuntuMobileIndex&&-1===ubuntuTabletIndex||(this.browser=BrowserType.UBUNTU,this.browserVersion=1)}else this.browser=BrowserType.FIREFOX,versionIndex=-1!==firefoxIndex?firefoxIndex+8:iceweaselIndex+10;if(-1!==versionIndex){var mainVersionEndIndex=this.userAgent.indexOf(".",versionIndex);if(-1!==mainVersionEndIndex)try{this.browserVersion=Number(this.userAgent.substring(versionIndex,mainVersionEndIndex+2))}catch(e){}}0===this.browserVersion&&(this.browser=BrowserType.OTHER)}},{key:"extractIosVersion",value:function(){var versionIndex=this.userAgent.indexOf(" OS ");if(-1!==versionIndex){this.browser=BrowserType.SAFARI;try{for(var pos=versionIndex+4,hadNan=!1;pos<this.userAgent.length;)if(pos++,isNaN(Number(this.userAgent.charAt(pos)))){if(hadNan)break;hadNan=!0}var numberString=this.userAgent.substring(versionIndex+4,pos);this.browserVersion=Number(numberString.replace(/_/g,"."))}catch(e){}}}},{key:"_setDeviceInfo",value:function(){this.device=DeviceType.DESKTOP,null!=this.userAgent.match(/iPad.*AppleWebKit/)||/Macintosh; Intel Mac OS X.*AppleWebKit/.test(this.userAgent)&&window.TouchEvent&&!1===/.*Chrome.*/.test(this.userAgent)?this.device=DeviceType.IPAD:null!=this.userAgent.match(/iPhone.*AppleWebKit/)?this.device=DeviceType.IPHONE:null!=this.userAgent.match(/Android/)?null!=this.userAgent.match(/Ubuntu/)?this.device=DeviceType.OTHER_MOBILE:this.device=DeviceType.ANDROID:null!=this.userAgent.match(/Windows Phone/)?this.device=DeviceType.WINDOWS_PHONE:null!=this.userAgent.match(/Windows NT/)?this.device=DeviceType.DESKTOP:null!=this.userAgent.match(/BB10/)?this.device=DeviceType.BB:null==this.userAgent.match(/Mobile/)&&null==this.userAgent.match(/Tablet/)||(this.device=DeviceType.OTHER_MOBILE)}},{key:"isTouchSupported",value:function(){return"ontouchstart"in window}},{key:"isIos",value:function(){return this.device===DeviceType.IPAD||this.device===DeviceType.IPHONE}},{key:"cssPropertyValueSupported",value:function(prop,value){var d=document.createElement("div");return d.style[prop]=value,d.style[prop]===value}},{key:"getIdentifier",value:function(){return env.mode===Mode.App?client.device+" App":env.mode===Mode.Browser?client.browser+" Browser":"linux"===env.platformId?"Linux Desktop":"darwin"===env.platformId?"Mac Desktop":"win32"===env.platformId?"Windows Desktop":"Unknown"}},{key:"isIE",value:function(){return this.browser===BrowserType.IE}},{key:"isSupportedBrowserVersion",value:function(){return this.notOldFirefox()&&this.notOldChrome()}},{key:"notOldFirefox",value:function(){return this.browser!==BrowserType.FIREFOX||this.browserVersion>40}},{key:"notOldChrome",value:function(){return this.browser!==BrowserType.CHROME||this.browserVersion>37}},{key:"canDownloadMultipleFiles",value:function(){return(this.browser!==BrowserType.FIREFOX||this.browserVersion<65)&&this.browser!==BrowserType.SAFARI}},{key:"needsDownloadBatches",value:function(){return client.browser===BrowserType.CHROME}},{key:"needsMicrotaskHack",value:function(){return this.isIos()||this.browser===BrowserType.SAFARI||this.browser===BrowserType.PALEMOON||this.browser===BrowserType.WATERFOX||this.browser===BrowserType.FIREFOX&&this.browserVersion<=60||this.browser===BrowserType.CHROME&&this.browserVersion<59}},{key:"needsExplicitIDBIds",value:function(){return this.browser===BrowserType.SAFARI&&this.browserVersion<12.2}},{key:"indexedDBSupported",value:function(){return this.indexedDb()&&!this.isIE()}},{key:"calendarSupported",value:function(){return!this.isIE()}},{key:"browserData",value:function(){return{needsMicrotaskHack:this.needsMicrotaskHack(),needsExplicitIDBIds:this.needsExplicitIDBIds(),indexedDbSupported:this.indexedDBSupported()}}}]),ClientDetector}(),_export("client",client=new ClientDetector),_export("client",client)}}}),System.register("src/misc/DeviceConfig.js",["node_modules/systemjs-plugin-babel/babel-helpers/classCallCheck.js","node_modules/systemjs-plugin-babel/babel-helpers/createClass.js","../api/Env","../gui/theme","./ClientDetector","../api/common/utils/Encoding"],function(_export,_context){"use strict";var _classCallCheck,_createClass,assertMainOrNodeBoot,themeId,client,uint8ArrayToBase64,ConfigVersion,DeviceConfig,deviceConfig;return{setters:[function(_node_modulesSystemjsPluginBabelBabelHelpersClassCallCheckJs){_classCallCheck=_node_modulesSystemjsPluginBabelBabelHelpersClassCallCheckJs.default},function(_node_modulesSystemjsPluginBabelBabelHelpersCreateClassJs){_createClass=_node_modulesSystemjsPluginBabelBabelHelpersCreateClassJs.default},function(_apiEnv){assertMainOrNodeBoot=_apiEnv.assertMainOrNodeBoot},function(_guiTheme){themeId=_guiTheme.themeId},function(_ClientDetector){client=_ClientDetector.client},function(_apiCommonUtilsEncoding){uint8ArrayToBase64=_apiCommonUtilsEncoding.uint8ArrayToBase64}],execute:function(){assertMainOrNodeBoot(),ConfigVersion=2,"tutanotaConfig",DeviceConfig=function(){function DeviceConfig(){_classCallCheck(this,DeviceConfig),this._version=ConfigVersion,this._load()}return _createClass(DeviceConfig,[{key:"_load",value:function(){this._credentials=[];var loadedConfigString=client.localStorage()?localStorage.getItem("tutanotaConfig"):null,loadedConfig=null!=loadedConfigString?JSON.parse(loadedConfigString):null;this._theme=loadedConfig&&loadedConfig._theme?loadedConfig._theme:"light",loadedConfig&&loadedConfig._version===ConfigVersion&&(this._credentials=loadedConfig._credentials),this._scheduledAlarmUsers=loadedConfig&&loadedConfig._scheduledAlarmUsers||[],this._language=loadedConfig&&loadedConfig._language,this._defaultCalendarView=loadedConfig&&loadedConfig._defaultCalendarView||{};var loadedSignupToken=loadedConfig&&loadedConfig._signupToken;if(loadedSignupToken)this._signupToken=loadedSignupToken;else{var bytes=new Uint8Array(6);crypto.getRandomValues(bytes),this._signupToken=uint8ArrayToBase64(bytes),this._store()}}},{key:"getSignupToken",value:function(){return this._signupToken}},{key:"getStoredAddresses",value:function(){return this._credentials.map(function(c){return c.mailAddress})}},{key:"get",value:function(mailAddress){return this._credentials.find(function(c){return c.mailAddress===mailAddress})}},{key:"getByUserId",value:function(id){return this._credentials.find(function(c){return c.userId===id})}},{key:"hasScheduledAlarmsForUser",value:function(userId){return this._scheduledAlarmUsers.includes(userId)}},{key:"setAlarmsScheduledForUser",value:function(userId,setScheduled){var scheduledIndex=this._scheduledAlarmUsers.indexOf(userId),scheduledSaved=-1!==scheduledIndex;setScheduled&&!scheduledSaved?this._scheduledAlarmUsers.push(userId):!setScheduled&&scheduledSaved&&this._scheduledAlarmUsers.splice(scheduledIndex,1),this._store()}},{key:"setNoAlarmsScheduled",value:function(){this._scheduledAlarmUsers=[],this._store()}},{key:"getLanguage",value:function(){return this._language}},{key:"setLanguage",value:function(language){this._language=language,this._store()}},{key:"set",value:function(credentials){var index=this._credentials.findIndex(function(c){return c.mailAddress===credentials.mailAddress});-1!==index?this._credentials[index]=credentials:this._credentials.push(credentials),this._store()}},{key:"delete",value:function(mailAddress){this._credentials.splice(this._credentials.findIndex(function(c){return c.mailAddress===mailAddress}),1),this._store()}},{key:"deleteByAccessToken",value:function(accessToken){this._credentials.splice(this._credentials.findIndex(function(c){return c.accessToken===accessToken}),1),this._store()}},{key:"_store",value:function(){try{localStorage.setItem("tutanotaConfig",JSON.stringify(this))}catch(e){console.log("could not store config",e)}}},{key:"getAll",value:function(){return JSON.parse(JSON.stringify(this._credentials))}},{key:"getAllInternal",value:function(){return this.getAll().filter(function(credential){return credential.mailAddress.indexOf("@")>0})}},{key:"getTheme",value:function(){return this._theme}},{key:"setTheme",value:function(theme){this._theme!==theme&&(this._theme=theme,themeId(theme),this._store())}},{key:"getDefaultCalendarView",value:function(userId){return this._defaultCalendarView[userId]}},{key:"setDefaultCalendarView",value:function(userId,defaultView){this._defaultCalendarView[userId]!==defaultView&&(this._defaultCalendarView[userId]=defaultView,this._store())}}]),DeviceConfig}(),_export("deviceConfig",deviceConfig=new DeviceConfig),_export("deviceConfig",deviceConfig)}}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():System.registerDynamic("libs/purify.js",[],!1,function($__require,$__exports,$__module){return factory.call(this)})}(0,function(){"use strict";var hasOwnProperty=Object.hasOwnProperty,setPrototypeOf=Object.setPrototypeOf,isFrozen=Object.isFrozen,objectKeys=Object.keys,freeze=Object.freeze,seal=Object.seal,_ref="undefined"!=typeof Reflect&&Reflect,apply=_ref.apply,construct=_ref.construct;apply||(apply=function(fun,thisValue,args){return fun.apply(thisValue,args)}),freeze||(freeze=function(x){return x}),seal||(seal=function(x){return x}),construct||(construct=function(Func,args){return new(Function.prototype.bind.apply(Func,[null].concat(function(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}(args))))});var arrayForEach=unapply(Array.prototype.forEach),arrayIndexOf=unapply(Array.prototype.indexOf),arrayJoin=unapply(Array.prototype.join),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),arraySlice=unapply(Array.prototype.slice),stringToLowerCase=unapply(String.prototype.toLowerCase),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),regExpTest=unapply(RegExp.prototype.test),regExpCreate=unconstruct(RegExp),typeErrorCreate=unconstruct(TypeError);function unapply(func){return function(thisArg){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];return apply(func,thisArg,args)}}function unconstruct(func){return function(){for(var _len2=arguments.length,args=Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return construct(func,args)}}function addToSet(set,array){setPrototypeOf&&setPrototypeOf(set,null);for(var l=array.length;l--;){var element=array[l];if("string"==typeof element){var lcElement=stringToLowerCase(element);lcElement!==element&&(isFrozen(array)||(array[l]=lcElement),element=lcElement)}set[element]=!0}return set}function clone(object){var newObject={},property=void 0;for(property in object)apply(hasOwnProperty,object,[property])&&(newObject[property]=object[property]);return newObject}var html=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"]),svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),mathMl=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),text=freeze(["#text"]),html$1=freeze(["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","coords","crossorigin","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","integrity","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","minlength","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns"]),svg$1=freeze(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl$1=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal(/\{\{[\s\S]*|[\s\S]*\}\}/gm),ERB_EXPR=seal(/<%[\s\S]*|[\s\S]*%>/gm),DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]/),ARIA_ATTR=seal(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}var getGlobal=function(){return"undefined"==typeof window?null:window},_createTrustedTypesPolicy=function(trustedTypes,document){if("object"!==(void 0===trustedTypes?"undefined":_typeof(trustedTypes))||"function"!=typeof trustedTypes.createPolicy)return null;var suffix=null;document.currentScript&&document.currentScript.hasAttribute("data-tt-policy-suffix")&&(suffix=document.currentScript.getAttribute("data-tt-policy-suffix"));var policyName="dompurify"+(suffix?"#"+suffix:"");try{return trustedTypes.createPolicy(policyName,{createHTML:function(html$$1){return html$$1}})}catch(error){return console.warn("TrustedTypes policy "+policyName+" could not be created."),null}};return function createDOMPurify(){var window=arguments.length>0&&void 0!==arguments[0]?arguments[0]:getGlobal(),DOMPurify=function(root){return createDOMPurify(root)};if(DOMPurify.version="2.0.8",DOMPurify.removed=[],!window||!window.document||9!==window.document.nodeType)return DOMPurify.isSupported=!1,DOMPurify;var originalDocument=window.document,useDOMParser=!1,removeTitle=!1,document=window.document,DocumentFragment=window.DocumentFragment,HTMLTemplateElement=window.HTMLTemplateElement,Node=window.Node,NodeFilter=window.NodeFilter,_window$NamedNodeMap=window.NamedNodeMap,NamedNodeMap=void 0===_window$NamedNodeMap?window.NamedNodeMap||window.MozNamedAttrMap:_window$NamedNodeMap,Text=window.Text,Comment=window.Comment,DOMParser=window.DOMParser,trustedTypes=window.trustedTypes;if("function"==typeof HTMLTemplateElement){var template=document.createElement("template");template.content&&template.content.ownerDocument&&(document=template.content.ownerDocument)}var trustedTypesPolicy=_createTrustedTypesPolicy(trustedTypes,originalDocument),emptyHTML=trustedTypesPolicy?trustedTypesPolicy.createHTML(""):"",_document=document,implementation=_document.implementation,createNodeIterator=_document.createNodeIterator,getElementsByTagName=_document.getElementsByTagName,createDocumentFragment=_document.createDocumentFragment,importNode=originalDocument.importNode,hooks={};DOMPurify.isSupported=implementation&&void 0!==implementation.createHTMLDocument&&9!==document.documentMode;var MUSTACHE_EXPR$$1=MUSTACHE_EXPR,ERB_EXPR$$1=ERB_EXPR,DATA_ATTR$$1=DATA_ATTR,ARIA_ATTR$$1=ARIA_ATTR,IS_SCRIPT_OR_DATA$$1=IS_SCRIPT_OR_DATA,ATTR_WHITESPACE$$1=ATTR_WHITESPACE,IS_ALLOWED_URI$$1=IS_ALLOWED_URI,ALLOWED_TAGS=null,DEFAULT_ALLOWED_TAGS=addToSet({},[].concat(_toConsumableArray(html),_toConsumableArray(svg),_toConsumableArray(svgFilters),_toConsumableArray(mathMl),_toConsumableArray(text))),ALLOWED_ATTR=null,DEFAULT_ALLOWED_ATTR=addToSet({},[].concat(_toConsumableArray(html$1),_toConsumableArray(svg$1),_toConsumableArray(mathMl$1),_toConsumableArray(xml))),FORBID_TAGS=null,FORBID_ATTR=null,ALLOW_ARIA_ATTR=!0,ALLOW_DATA_ATTR=!0,ALLOW_UNKNOWN_PROTOCOLS=!1,SAFE_FOR_JQUERY=!1,SAFE_FOR_TEMPLATES=!1,WHOLE_DOCUMENT=!1,SET_CONFIG=!1,FORCE_BODY=!1,RETURN_DOM=!1,RETURN_DOM_FRAGMENT=!1,RETURN_DOM_IMPORT=!1,RETURN_TRUSTED_TYPE=!1,SANITIZE_DOM=!0,KEEP_CONTENT=!0,IN_PLACE=!1,USE_PROFILES={},FORBID_CONTENTS=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","plaintext","script","style","svg","template","thead","title","video","xmp"]),DATA_URI_TAGS=addToSet({},["audio","video","img","source","image"]),URI_SAFE_ATTRIBUTES=null,DEFAULT_URI_SAFE_ATTRIBUTES=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),CONFIG=null,formElement=document.createElement("form"),_parseConfig=function(cfg){CONFIG&&CONFIG===cfg||(cfg&&"object"===(void 0===cfg?"undefined":_typeof(cfg))||(cfg={}),ALLOWED_TAGS="ALLOWED_TAGS"in cfg?addToSet({},cfg.ALLOWED_TAGS):DEFAULT_ALLOWED_TAGS,ALLOWED_ATTR="ALLOWED_ATTR"in cfg?addToSet({},cfg.ALLOWED_ATTR):DEFAULT_ALLOWED_ATTR,URI_SAFE_ATTRIBUTES="ADD_URI_SAFE_ATTR"in cfg?addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES),cfg.ADD_URI_SAFE_ATTR):DEFAULT_URI_SAFE_ATTRIBUTES,FORBID_TAGS="FORBID_TAGS"in cfg?addToSet({},cfg.FORBID_TAGS):{},FORBID_ATTR="FORBID_ATTR"in cfg?addToSet({},cfg.FORBID_ATTR):{},USE_PROFILES="USE_PROFILES"in cfg&&cfg.USE_PROFILES,ALLOW_ARIA_ATTR=!1!==cfg.ALLOW_ARIA_ATTR,ALLOW_DATA_ATTR=!1!==cfg.ALLOW_DATA_ATTR,ALLOW_UNKNOWN_PROTOCOLS=cfg.ALLOW_UNKNOWN_PROTOCOLS||!1,SAFE_FOR_JQUERY=cfg.SAFE_FOR_JQUERY||!1,SAFE_FOR_TEMPLATES=cfg.SAFE_FOR_TEMPLATES||!1,WHOLE_DOCUMENT=cfg.WHOLE_DOCUMENT||!1,RETURN_DOM=cfg.RETURN_DOM||!1,RETURN_DOM_FRAGMENT=cfg.RETURN_DOM_FRAGMENT||!1,RETURN_DOM_IMPORT=cfg.RETURN_DOM_IMPORT||!1,RETURN_TRUSTED_TYPE=cfg.RETURN_TRUSTED_TYPE||!1,FORCE_BODY=cfg.FORCE_BODY||!1,SANITIZE_DOM=!1!==cfg.SANITIZE_DOM,KEEP_CONTENT=!1!==cfg.KEEP_CONTENT,IN_PLACE=cfg.IN_PLACE||!1,IS_ALLOWED_URI$$1=cfg.ALLOWED_URI_REGEXP||IS_ALLOWED_URI$$1,SAFE_FOR_TEMPLATES&&(ALLOW_DATA_ATTR=!1),RETURN_DOM_FRAGMENT&&(RETURN_DOM=!0),USE_PROFILES&&(ALLOWED_TAGS=addToSet({},[].concat(_toConsumableArray(text))),ALLOWED_ATTR=[],!0===USE_PROFILES.html&&(addToSet(ALLOWED_TAGS,html),addToSet(ALLOWED_ATTR,html$1)),!0===USE_PROFILES.svg&&(addToSet(ALLOWED_TAGS,svg),addToSet(ALLOWED_ATTR,svg$1),addToSet(ALLOWED_ATTR,xml)),!0===USE_PROFILES.svgFilters&&(addToSet(ALLOWED_TAGS,svgFilters),addToSet(ALLOWED_ATTR,svg$1),addToSet(ALLOWED_ATTR,xml)),!0===USE_PROFILES.mathMl&&(addToSet(ALLOWED_TAGS,mathMl),addToSet(ALLOWED_ATTR,mathMl$1),addToSet(ALLOWED_ATTR,xml))),cfg.ADD_TAGS&&(ALLOWED_TAGS===DEFAULT_ALLOWED_TAGS&&(ALLOWED_TAGS=clone(ALLOWED_TAGS)),addToSet(ALLOWED_TAGS,cfg.ADD_TAGS)),cfg.ADD_ATTR&&(ALLOWED_ATTR===DEFAULT_ALLOWED_ATTR&&(ALLOWED_ATTR=clone(ALLOWED_ATTR)),addToSet(ALLOWED_ATTR,cfg.ADD_ATTR)),cfg.ADD_URI_SAFE_ATTR&&addToSet(URI_SAFE_ATTRIBUTES,cfg.ADD_URI_SAFE_ATTR),KEEP_CONTENT&&(ALLOWED_TAGS["#text"]=!0),WHOLE_DOCUMENT&&addToSet(ALLOWED_TAGS,["html","head","body"]),ALLOWED_TAGS.table&&(addToSet(ALLOWED_TAGS,["tbody"]),delete FORBID_TAGS.tbody),freeze&&freeze(cfg),CONFIG=cfg)},_forceRemove=function(node){arrayPush(DOMPurify.removed,{element:node});try{node.parentNode.removeChild(node)}catch(error){node.outerHTML=emptyHTML}},_removeAttribute=function(name,node){try{arrayPush(DOMPurify.removed,{attribute:node.getAttributeNode(name),from:node})}catch(error){arrayPush(DOMPurify.removed,{attribute:null,from:node})}node.removeAttribute(name)},_initDocument=function(dirty){var doc=void 0,leadingWhitespace=void 0;if(FORCE_BODY)dirty="<remove></remove>"+dirty;else{var matches=stringMatch(dirty,/^[\s]+/);leadingWhitespace=matches&&matches[0]}var dirtyPayload=trustedTypesPolicy?trustedTypesPolicy.createHTML(dirty):dirty;if(useDOMParser)try{doc=(new DOMParser).parseFromString(dirtyPayload,"text/html")}catch(error){}if(removeTitle&&addToSet(FORBID_TAGS,["title"]),!doc||!doc.documentElement){var body=(doc=implementation.createHTMLDocument("")).body;body.parentNode.removeChild(body.parentNode.firstElementChild),body.outerHTML=dirtyPayload}return dirty&&leadingWhitespace&&doc.body.insertBefore(document.createTextNode(leadingWhitespace),doc.body.childNodes[0]||null),getElementsByTagName.call(doc,WHOLE_DOCUMENT?"html":"body")[0]};DOMPurify.isSupported&&(function(){try{_initDocument('<svg><p><textarea><img src="</textarea><img src=x abc=1//">').querySelector("svg img")&&(useDOMParser=!0)}catch(error){}}(),function(){try{var doc=_initDocument("<x/><title>&lt;/title&gt;&lt;img&gt;");regExpTest(/<\/title/,doc.querySelector("title").innerHTML)&&(removeTitle=!0)}catch(error){}}());var _createIterator=function(root){return createNodeIterator.call(root.ownerDocument||root,root,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT,function(){return NodeFilter.FILTER_ACCEPT},!1)},_isNode=function(obj){return"object"===(void 0===Node?"undefined":_typeof(Node))?obj instanceof Node:obj&&"object"===(void 0===obj?"undefined":_typeof(obj))&&"number"==typeof obj.nodeType&&"string"==typeof obj.nodeName},_executeHook=function(entryPoint,currentNode,data){hooks[entryPoint]&&arrayForEach(hooks[entryPoint],function(hook){hook.call(DOMPurify,currentNode,data,CONFIG)})},_sanitizeElements=function(currentNode){var elm,content=void 0;if(_executeHook("beforeSanitizeElements",currentNode,null),!((elm=currentNode)instanceof Text||elm instanceof Comment||"string"==typeof elm.nodeName&&"string"==typeof elm.textContent&&"function"==typeof elm.removeChild&&elm.attributes instanceof NamedNodeMap&&"function"==typeof elm.removeAttribute&&"function"==typeof elm.setAttribute&&"string"==typeof elm.namespaceURI))return _forceRemove(currentNode),!0;var tagName=stringToLowerCase(currentNode.nodeName);if(_executeHook("uponSanitizeElement",currentNode,{tagName:tagName,allowedTags:ALLOWED_TAGS}),("svg"===tagName||"math"===tagName)&&0!==currentNode.querySelectorAll("p, br").length)return _forceRemove(currentNode),!0;if(!ALLOWED_TAGS[tagName]||FORBID_TAGS[tagName]){if(KEEP_CONTENT&&!FORBID_CONTENTS[tagName]&&"function"==typeof currentNode.insertAdjacentHTML)try{var htmlToInsert=currentNode.innerHTML;currentNode.insertAdjacentHTML("AfterEnd",trustedTypesPolicy?trustedTypesPolicy.createHTML(htmlToInsert):htmlToInsert)}catch(error){}return _forceRemove(currentNode),!0}return"noscript"===tagName&&regExpTest(/<\/noscript/i,currentNode.innerHTML)?(_forceRemove(currentNode),!0):"noembed"===tagName&&regExpTest(/<\/noembed/i,currentNode.innerHTML)?(_forceRemove(currentNode),!0):(!SAFE_FOR_JQUERY||currentNode.firstElementChild||currentNode.content&&currentNode.content.firstElementChild||!regExpTest(/</g,currentNode.textContent)||(arrayPush(DOMPurify.removed,{element:currentNode.cloneNode()}),currentNode.innerHTML?currentNode.innerHTML=stringReplace(currentNode.innerHTML,/</g,"&lt;"):currentNode.innerHTML=stringReplace(currentNode.textContent,/</g,"&lt;")),SAFE_FOR_TEMPLATES&&3===currentNode.nodeType&&(content=currentNode.textContent,content=stringReplace(content,MUSTACHE_EXPR$$1," "),content=stringReplace(content,ERB_EXPR$$1," "),currentNode.textContent!==content&&(arrayPush(DOMPurify.removed,{element:currentNode.cloneNode()}),currentNode.textContent=content)),_executeHook("afterSanitizeElements",currentNode,null),!1)},_isValidAttribute=function(lcTag,lcName,value){if(SANITIZE_DOM&&("id"===lcName||"name"===lcName)&&(value in document||value in formElement))return!1;if(ALLOW_DATA_ATTR&&regExpTest(DATA_ATTR$$1,lcName));else if(ALLOW_ARIA_ATTR&&regExpTest(ARIA_ATTR$$1,lcName));else{if(!ALLOWED_ATTR[lcName]||FORBID_ATTR[lcName])return!1;if(URI_SAFE_ATTRIBUTES[lcName]);else if(regExpTest(IS_ALLOWED_URI$$1,stringReplace(value,ATTR_WHITESPACE$$1,"")));else if("src"!==lcName&&"xlink:href"!==lcName&&"href"!==lcName||"script"===lcTag||0!==stringIndexOf(value,"data:")||!DATA_URI_TAGS[lcTag])if(ALLOW_UNKNOWN_PROTOCOLS&&!regExpTest(IS_SCRIPT_OR_DATA$$1,stringReplace(value,ATTR_WHITESPACE$$1,"")));else if(value)return!1}return!0},_sanitizeAttributes=function(currentNode){var attr=void 0,value=void 0,lcName=void 0,idAttr=void 0,l=void 0;_executeHook("beforeSanitizeAttributes",currentNode,null);var attributes=currentNode.attributes;if(attributes){var hookEvent={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ALLOWED_ATTR};for(l=attributes.length;l--;){var _attr=attr=attributes[l],name=_attr.name,namespaceURI=_attr.namespaceURI;if(value=stringTrim(attr.value),lcName=stringToLowerCase(name),hookEvent.attrName=lcName,hookEvent.attrValue=value,hookEvent.keepAttr=!0,hookEvent.forceKeepAttr=void 0,_executeHook("uponSanitizeAttribute",currentNode,hookEvent),value=hookEvent.attrValue,!hookEvent.forceKeepAttr){if("name"===lcName&&"IMG"===currentNode.nodeName&&attributes.id)idAttr=attributes.id,attributes=arraySlice(attributes,[]),_removeAttribute("id",currentNode),_removeAttribute(name,currentNode),arrayIndexOf(attributes,idAttr)>l&&currentNode.setAttribute("id",idAttr.value);else{if("INPUT"===currentNode.nodeName&&"type"===lcName&&"file"===value&&hookEvent.keepAttr&&(ALLOWED_ATTR[lcName]||!FORBID_ATTR[lcName]))continue;"id"===name&&currentNode.setAttribute(name,""),_removeAttribute(name,currentNode)}if(hookEvent.keepAttr)if(SAFE_FOR_JQUERY&&regExpTest(/\/>/i,value))_removeAttribute(name,currentNode);else if(regExpTest(/svg|math/i,currentNode.namespaceURI)&&regExpTest(regExpCreate("</("+arrayJoin(objectKeys(FORBID_CONTENTS),"|")+")","i"),value))_removeAttribute(name,currentNode);else{SAFE_FOR_TEMPLATES&&(value=stringReplace(value,MUSTACHE_EXPR$$1," "),value=stringReplace(value,ERB_EXPR$$1," "));var lcTag=currentNode.nodeName.toLowerCase();if(_isValidAttribute(lcTag,lcName,value))try{namespaceURI?currentNode.setAttributeNS(namespaceURI,name,value):currentNode.setAttribute(name,value),arrayPop(DOMPurify.removed)}catch(error){}}}}_executeHook("afterSanitizeAttributes",currentNode,null)}},_sanitizeShadowDOM=function _sanitizeShadowDOM(fragment){var shadowNode=void 0,shadowIterator=_createIterator(fragment);for(_executeHook("beforeSanitizeShadowDOM",fragment,null);shadowNode=shadowIterator.nextNode();)_executeHook("uponSanitizeShadowNode",shadowNode,null),_sanitizeElements(shadowNode)||(shadowNode.content instanceof DocumentFragment&&_sanitizeShadowDOM(shadowNode.content),_sanitizeAttributes(shadowNode));_executeHook("afterSanitizeShadowDOM",fragment,null)};return DOMPurify.sanitize=function(dirty,cfg){var body=void 0,importedNode=void 0,currentNode=void 0,oldNode=void 0,returnNode=void 0;if(dirty||(dirty="\x3c!--\x3e"),"string"!=typeof dirty&&!_isNode(dirty)){if("function"!=typeof dirty.toString)throw typeErrorCreate("toString is not a function");if("string"!=typeof(dirty=dirty.toString()))throw typeErrorCreate("dirty is not a string, aborting")}if(!DOMPurify.isSupported){if("object"===_typeof(window.toStaticHTML)||"function"==typeof window.toStaticHTML){if("string"==typeof dirty)return window.toStaticHTML(dirty);if(_isNode(dirty))return window.toStaticHTML(dirty.outerHTML)}return dirty}if(SET_CONFIG||_parseConfig(cfg),DOMPurify.removed=[],"string"==typeof dirty&&(IN_PLACE=!1),IN_PLACE);else if(dirty instanceof Node)1===(importedNode=(body=_initDocument("\x3c!--\x3e")).ownerDocument.importNode(dirty,!0)).nodeType&&"BODY"===importedNode.nodeName?body=importedNode:"HTML"===importedNode.nodeName?body=importedNode:body.appendChild(importedNode);else{if(!RETURN_DOM&&!SAFE_FOR_TEMPLATES&&!WHOLE_DOCUMENT&&RETURN_TRUSTED_TYPE&&-1===dirty.indexOf("<"))return trustedTypesPolicy?trustedTypesPolicy.createHTML(dirty):dirty;if(!(body=_initDocument(dirty)))return RETURN_DOM?null:emptyHTML}body&&FORCE_BODY&&_forceRemove(body.firstChild);for(var nodeIterator=_createIterator(IN_PLACE?dirty:body);currentNode=nodeIterator.nextNode();)3===currentNode.nodeType&&currentNode===oldNode||_sanitizeElements(currentNode)||(currentNode.content instanceof DocumentFragment&&_sanitizeShadowDOM(currentNode.content),_sanitizeAttributes(currentNode),oldNode=currentNode);if(oldNode=null,IN_PLACE)return dirty;if(RETURN_DOM){if(RETURN_DOM_FRAGMENT)for(returnNode=createDocumentFragment.call(body.ownerDocument);body.firstChild;)returnNode.appendChild(body.firstChild);else returnNode=body;return RETURN_DOM_IMPORT&&(returnNode=importNode.call(originalDocument,returnNode,!0)),returnNode}var serializedHTML=WHOLE_DOCUMENT?body.outerHTML:body.innerHTML;return SAFE_FOR_TEMPLATES&&(serializedHTML=stringReplace(serializedHTML,MUSTACHE_EXPR$$1," "),serializedHTML=stringReplace(serializedHTML,ERB_EXPR$$1," ")),trustedTypesPolicy&&RETURN_TRUSTED_TYPE?trustedTypesPolicy.createHTML(serializedHTML):serializedHTML},DOMPurify.setConfig=function(cfg){_parseConfig(cfg),SET_CONFIG=!0},DOMPurify.clearConfig=function(){CONFIG=null,SET_CONFIG=!1},DOMPurify.isValidAttribute=function(tag,attr,value){CONFIG||_parseConfig({});var lcTag=stringToLowerCase(tag),lcName=stringToLowerCase(attr);return _isValidAttribute(lcTag,lcName,value)},DOMPurify.addHook=function(entryPoint,hookFunction){"function"==typeof hookFunction&&(hooks[entryPoint]=hooks[entryPoint]||[],arrayPush(hooks[entryPoint],hookFunction))},DOMPurify.removeHook=function(entryPoint){hooks[entryPoint]&&arrayPop(hooks[entryPoint])},DOMPurify.removeHooks=function(entryPoint){hooks[entryPoint]&&(hooks[entryPoint]=[])},DOMPurify.removeAllHooks=function(){hooks={}},DOMPurify}()}),System.register("src/gui/theme.js",["./base/icons/Logo","../misc/DeviceConfig","mithril/stream/stream.js","../api/Env","dompurify"],function(_export,_context){"use strict";var LogoSvg,deviceConfig,stream,assertMainOrNodeBoot,DOMPurify,themeId,customTheme,theme,defaultTheme;function getTheme(){switch(themeId()){case"custom":return Object.assign({},getLightTheme(),customTheme);case"dark":return green="#00d2a7",{logo:LogoSvg.Cyan,button_bubble_bg:"#4e4e4e",button_bubble_fg:"#DDDDDD",content_fg:"#DDDDDD",content_button:"#aeaeae",content_button_selected:green,content_button_icon_bg:"#4e4e4e",content_button_icon:"#DDDDDD",content_button_icon_selected:"#232323",content_accent:green,content_bg:"#111111",content_border:"#363636",content_message_bg:"#4e4e4e",header_bg:"#222222",header_box_shadow_bg:"#111111",header_button:"#aeaeae",header_button_selected:green,list_bg:"#111111",list_alternate_bg:"#232323",list_accent_fg:green,list_message_bg:"#4e4e4e",list_border:"#363636",modal_bg:"#111111",elevated_bg:"#232323",navigation_bg:"#232323",navigation_border:"#363636",navigation_button:"#aeaeae",navigation_button_icon_bg:"#4e4e4e",navigation_button_icon:"#DDDDDD",navigation_button_selected:green,navigation_button_icon_selected:"#aeaeae",navigation_menu_bg:"#111111",navigation_menu_icon:"#999999"};default:return getLightTheme()}var green}function updateCustomTheme(updatedTheme){updatedTheme.logo&&(updatedTheme.logo=DOMPurify.sanitize(updatedTheme.logo)),customTheme=Object.assign({},defaultTheme,updatedTheme),themeId("custom")}function getLightTheme(){var light="#ffffff",red="#840010";return{logo:LogoSvg.Red,button_bubble_bg:"#eaeaea",button_bubble_fg:"#303030",content_fg:"#303030",content_button:"#707070",content_button_selected:red,content_button_icon:light,content_button_icon_selected:light,content_accent:red,content_bg:light,content_border:"#d5d5d5",content_message_bg:"#b8b8b8",header_bg:light,header_box_shadow_bg:"#d5d5d5",header_button:"#707070",header_button_selected:red,list_bg:light,list_alternate_bg:"#f6f6f6",list_accent_fg:red,list_message_bg:"#b8b8b8",list_border:"#e1e1e1",modal_bg:"#303030",elevated_bg:light,navigation_bg:"#f6f6f6",navigation_border:"#e1e1e1",navigation_button:"#707070",navigation_button_icon:light,navigation_button_selected:red,navigation_button_icon_selected:light,navigation_menu_bg:"#eaeaea",navigation_menu_icon:"#868686"}}return _export("updateCustomTheme",updateCustomTheme),_export("getContentButtonIconBackground",function(){return theme.content_button_icon_bg||theme.content_button}),_export("getNavButtonIconBackground",function(){return theme.navigation_button_icon_bg||theme.navigation_button}),_export("getElevatedBackground",function(){return theme.elevated_bg||theme.content_bg}),_export("getNavigationMenuBg",function(){return theme.navigation_menu_bg||theme.navigation_bg}),_export("getNavigationMenuIcon",function(){return theme.navigation_menu_icon||theme.navigation_button_icon}),{setters:[function(_baseIconsLogo){LogoSvg=_baseIconsLogo.LogoSvg},function(_miscDeviceConfig){deviceConfig=_miscDeviceConfig.deviceConfig},function(_mithrilStreamStreamJs){stream=_mithrilStreamStreamJs.default},function(_apiEnv){assertMainOrNodeBoot=_apiEnv.assertMainOrNodeBoot},function(_dompurify){DOMPurify=_dompurify.default}],execute:function(){assertMainOrNodeBoot(),_export("themeId",themeId=stream(deviceConfig.getTheme()?deviceConfig.getTheme():"light")),_export("themeId",themeId),customTheme=null,"undefined"!=typeof whitelabelCustomizations&&whitelabelCustomizations&&whitelabelCustomizations.theme&&updateCustomTheme(whitelabelCustomizations.theme),_export("theme",theme=getTheme()),_export("theme",theme),_export("defaultTheme",defaultTheme=getLightTheme()),_export("defaultTheme",defaultTheme),themeId.map(function(){_export("theme",theme=Object.assign(getLightTheme(),getTheme()))})}}});
//# sourceMappingURL=theme.js.map